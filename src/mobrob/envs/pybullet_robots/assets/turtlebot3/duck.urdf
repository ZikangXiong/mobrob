<?xml version="1.0" ?>
<!-- =================================================================================== -->
<!-- |    This document was autogenerated by xacro from duckiebot.xacro                | -->
<!-- |    EDITING THIS FILE BY HAND IS NOT RECOMMENDED                                 | -->
<!-- =================================================================================== -->
<robot name="duckiebot" xmlns:xacro="http://www.ros.org/wiki/xacro">
  <gazebo>
    <plugin filename="libgazebo_ros_diff_drive.so" name="differential_drive_controller">
      <legacyMode>false</legacyMode>
      <alwaysOn>true</alwaysOn>
      <updateRate>0</updateRate>
      <leftJoint>left_wheel_hinge</leftJoint>
      <rightJoint>right_wheel_hinge</rightJoint>
      <wheelSeparation>0.4</wheelSeparation>
      <wheelDiameter>0.1</wheelDiameter>
      <torque>20</torque>
      <commandTopic>cmd_vel</commandTopic>
      <odometryTopic>odom</odometryTopic>
      <odometryFrame>odom</odometryFrame>
      <robotBaseFrame>chassis</robotBaseFrame>
    </plugin>
  </gazebo>
  <gazebo reference="chassis">
    <material>Gazebo/Red</material>
  </gazebo>
  <gazebo reference="computer">
    <material>Gazebo/Green</material>
  </gazebo>
  <gazebo reference="camera">
    <material>Gazebo/Black</material>
  </gazebo>
  <gazebo reference="left_wheel">
    <material>Gazebo/Green</material>
  </gazebo>
  <gazebo reference="right_wheel">
    <material>Gazebo/Green</material>
  </gazebo>
  <gazebo reference="camera">
    <material>Gazebo/Green</material>
    <sensor name="camera1" type="camera">
      <update_rate>30.0</update_rate>
      <camera name="head">
        <horizontal_fov>1.04</horizontal_fov>
        <image>
          <width>320</width>
          <height>240</height>
          <format>R8G8B8</format>
        </image>
        <clip>
          <near>0.1</near>
          <far>50</far>
        </clip>
      </camera>
      <plugin filename="libgazebo_ros_camera.so" name="camera_controller">
        <alwaysOn>true</alwaysOn>
        <updateRate>0</updateRate>
        <cameraName>duckiebot/camera1</cameraName>
        <imageTopicName>image_raw</imageTopicName>
        <cameraInfoTopicName>camera_info</cameraInfoTopicName>
        <frameName>camera</frameName>
        <hackBaseline>0.07</hackBaseline>
        <distortionK1>0.0</distortionK1>
        <distortionK2>0.0</distortionK2>
        <distortionK3>0.0</distortionK3>
        <distortionT1>0.0</distortionT1>
        <distortionT2>0.0</distortionT2>
      </plugin>
    </sensor>
  </gazebo>
  <gazebo reference="chassis">
    <material>Gazebo/Orange</material>
  </gazebo>
  <material name="black">
    <color rgba="0.0 0.0 0.0 1.0"/>
  </material>
  <material name="blue">
    <color rgba="0.0 0.0 0.8 1.0"/>
  </material>
  <material name="green">
    <color rgba="0.0 0.8 0.0 1.0"/>
  </material>
  <material name="grey">
    <color rgba="0.2 0.2 0.2 1.0"/>
  </material>
  <material name="orange">
    <color rgba="1.0 0.423529411765 0.0392156862745 1.0"/>
  </material>
  <material name="brown">
    <color rgba="0.870588235294 0.811764705882 0.764705882353 1.0"/>
  </material>
  <material name="red">
    <color rgba="0.8 0.0 0.0 1.0"/>
  </material>
  <material name="white">
    <color rgba="1.0 1.0 1.0 1.0"/>
  </material>
  <!--macro name="cylinder_inertia" params="m r h">
    <inertia  ixx="${m*(3*r*r+h*h)/12}" ixy = "0" ixz = "0"
      iyy="${m*(3*r*r+h*h)/12}" iyz = "0"
      izz="${m*r*r/2}"
    />
  </macro>

  <macro name="box_inertia" params="m x y z">
    <inertia  ixx="${m*(y*y+z*z)/12}" ixy = "0" ixz = "0"
      iyy="${m*(x*x+z*z)/12}" iyz = "0"
      izz="${m*(x*x+z*z)/12}"
    />
  </macro>

  <macro name="sphere_inertia" params="m r">
    <inertia  ixx="${2*m*r*r/5}" ixy = "0" ixz = "0"
      iyy="${2*m*r*r/5}" iyz = "0"
      izz="${2*m*r*r/5}"
    />
  </macro>







  <macro name="wheel" params="lr tY">

    <link name="${lr}_wheel">
      <collision>
        <origin xyz="0 0 0" rpy="0 ${PI/2} ${PI/2}" />
        <geometry>
          <cylinder length="${wheelWidth}" radius="${wheelRadius}"/>
        </geometry>
      </collision>

      <visual>
        <origin xyz="0 0 0" rpy="0 ${PI/2} ${PI/2}" />
        <geometry>
          <cylinder length="${wheelWidth}" radius="${wheelRadius}"/>
        </geometry>
        <material name="black"/>
      </visual>

      <inertial>
        <origin xyz="0 0 0" rpy="0 ${PI/2} ${PI/2}" />
        <mass value="${wheelMass}"/>
        <cylinder_inertia m="${wheelMass}" r="${wheelRadius}" h="${wheelWidth}"/>
      </inertial>
    </link>

    <gazebo reference="${lr}_wheel">
      <mu1 value="1.0"/>
      <mu2 value="1.0"/>
      <kp  value="10000000.0" />
      <kd  value="1.0" />
      <fdir1 value="1 0 0"/>
      <material>Gazebo/Black</material>
    </gazebo>


    <joint name="${lr}_wheel_hinge" type="continuous">
      <parent link="chassis"/>
      <child link="${lr}_wheel"/>
    <origin xyz="${-wheelPos+chassisLength/2} ${tY*wheelWidth/2+tY*chassisWidth/2} ${wheelRadius}" rpy="0 0 0" />
      <axis xyz="0 1 0" rpy="0 0 0" />
      <limit effort="10000" velocity="10000"/>
      <joint_properties damping="0.0" friction="0.0"/>
    </joint>


    <transmission name="${lr}_trans">
      <type>transmission_interface/SimpleTransmission</type>
      <joint name="${lr}_wheel_hinge">
        <hardwareInterface>EffortJointInterface</hardwareInterface>
      </joint>
      <actuator name="${lr}Motor">
        <hardwareInterface>EffortJointInterface</hardwareInterface>
        <mechanicalReduction>10</mechanicalReduction>
      </actuator>
    </transmission>

  </macro-->
  <pose>0 0 0 0 0 0</pose>
  <link name="chassis">
    <inertial>
      <mass value="0.15"/>
      <origin rpy=" 0 0 0" xyz="-0.05 0 0"/>
      <inertia ixx="1.56167e-05" ixy="0.0" ixz="0.0" iyy="1.56167e-05" iyz="0.0" izz="2.56e-05"/>
    </inertial>
    <collision name="collision">
      <origin rpy=" 0 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="package://duckiebot_description/meshes/duckiebotFrame.dae"/>
      </geometry>
    </collision>
    <visual name="chassis_visual">
      <origin rpy=" 0 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="package://duckiebot_description/meshes/duckiebotFrame.dae"/>
      </geometry>
      <material name="red"/>
    </visual>
  </link>
  <link name="left_wheel">
    <origin rpy="0 0 0" xyz="0 0 0"/>
    <collision name="collision">
      <origin rpy="0 0 0" xyz="0 -0.07 0"/>
      <geometry>
        <mesh filename="package://duckiebot_description/meshes/duckiebot_leftwheel.dae"/>
      </geometry>
    </collision>
    <visual name="left_wheel_visual">
      <origin rpy="0 0 0" xyz="0 -0.07 0"/>
      <geometry>
        <mesh filename="package://duckiebot_description/meshes/duckiebot_leftwheel.dae"/>
      </geometry>
      <material name="black"/>
    </visual>
    <inertial>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <mass value="0.05"/>
      <cylinder_inertia h="0.02" m="0.05" r="0.0325"/>
      <inertia ixx="0.56167e-05" ixy="0.0" ixz="0.0" iyy="0.56167e-05" iyz="0.0" izz="1.56e-05"/>
    </inertial>
  </link>
  <link name="right_wheel">
    <origin rpy="0 0 0" xyz="0 0 0"/>
    <collision name="collision">
      <origin rpy="0 0 0" xyz="0 0.07 0"/>
      <geometry>
        <mesh filename="package://duckiebot_description/meshes/duckiebot_rightwheel.dae"/>
      </geometry>
    </collision>
    <visual name="right_wheel_visual">
      <origin rpy="0 0 0" xyz="0 0.07 0"/>
      <geometry>
        <mesh filename="package://duckiebot_description/meshes/duckiebot_rightwheel.dae"/>
      </geometry>
      <material name="black"/>
    </visual>
    <inertial>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <mass value="0.05"/>
      <cylinder_inertia h="0.01" m="0.05" r="0.0325"/>
      <inertia ixx="0.56167e-05" ixy="0.0" ixz="0.0" iyy="0.56167e-05" iyz="0.0" izz="1.56e-05"/>
    </inertial>
  </link>
  <joint name="left_wheel_hinge" type="continuous">
    <origin rpy="0 0 0" xyz="0.0 0.07 0"/>
    <child link="left_wheel"/>
    <parent link="chassis"/>
    <axis rpy="0 0 0" xyz="0 1 0"/>
    <limit effort="100" velocity="100"/>
    <joint_properties damping="0.0" friction="0.0"/>
  </joint>
  <joint name="right_wheel_hinge" type="continuous">
    <origin rpy="0 0 0" xyz="0.0 -0.07 0"/>
    <child link="right_wheel"/>
    <parent link="chassis"/>
    <axis rpy="0 0 0" xyz="0 1 0"/>
    <limit effort="100" velocity="100"/>
    <joint_properties damping="0.0" friction="0.0"/>
  </joint>
  <!-- Computer -->
  <link name="computer">
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="package://duckiebot_description/meshes/duckiebot_computer.dae"/>
      </geometry>
    </collision>
    <visual name="comp_visual">
      <origin rpy=" 0 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="package://duckiebot_description/meshes/duckiebot_computer.dae"/>
      </geometry>
      <material name="blue"/>
    </visual>
    <inertial>
      <mass value="0.01"/>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <inertia ixx="1e-6" ixy="0" ixz="0" iyy="1e-6" iyz="0" izz="1e-6"/>
    </inertial>
  </link>
  <joint name="computer_joint" type="fixed">
    <axis xyz="0 0 0"/>
    <origin rpy="0 0 0" xyz="0 0 0"/>
    <parent link="chassis"/>
    <child link="computer"/>
  </joint>
  <!-- Camera sensor -->
  <link name="camera">
    <pose>0 0 0 0 0 0</pose>
    <collision>
      <origin rpy="0 -0.1 0" xyz="-0.05 0 -0.055"/>
      <geometry>
        <mesh filename="package://duckiebot_description/meshes/duckiebot_camera.dae"/>
      </geometry>
    </collision>
    <visual name="camvisual">
      <origin rpy=" 0 -0.1 0" xyz="-0.05 0 -0.055"/>
      <geometry>
        <mesh filename="package://duckiebot_description/meshes/duckiebot_camera.dae"/>
      </geometry>
      <material name="black"/>
    </visual>
    <inertial>
      <mass value="0.01"/>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <inertia ixx="1e-6" ixy="0" ixz="0" iyy="1e-6" iyz="0" izz="1e-6"/>
    </inertial>
  </link>
  <!-- This joint info decides the pos of camera. Pitch(p in rpy) is angle to control orientation for duckiebot camera.After change values here, you need to change the pos info in collision part anf visual part just above.-->
  <joint name="camera_joint" type="fixed">
    <axis xyz="0 0 0"/>
    <origin rpy="0 0.1 0" xyz="0.05 0 0.05"/>
    <parent link="chassis"/>
    <child link="camera"/>
  </joint>
</robot>

